{"ast":null,"code":"import * as React from 'react';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport { ActionSheetIOS } from \"react-native-web/dist/index\";\nimport UIManager from \"react-native-web/dist/exports/UIManager\";\nimport findNodeHandle from \"react-native-web/dist/exports/findNodeHandle\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { HiddenItem } from \"./HeaderItems\";\nimport invariant from 'invariant';\nexport var extractOverflowButtonData = function extractOverflowButtonData(hiddenButtons) {\n  var detectedElementTypes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [HiddenItem];\n  var btnsData = React.Children.toArray(hiddenButtons).map(function (button) {\n    var props = button.props,\n        type = button.type;\n\n    if (detectedElementTypes.includes(type)) {\n      return extract(button);\n    }\n\n    if (typeof type === 'function') {\n      var nestedElement = callSafe(type, props);\n\n      if (nestedElement && detectedElementTypes.includes(nestedElement.type)) {\n        return extract(nestedElement);\n      }\n    }\n\n    return false;\n  });\n  return btnsData.filter(Boolean);\n};\n\nvar callSafe = function callSafe(type, props) {\n  try {\n    return type(props);\n  } catch (_unused) {\n    return false;\n  }\n};\n\nvar extract = function extract(element) {\n  var _element$props = element.props,\n      title = _element$props.title,\n      onPress = _element$props.onPress,\n      disabled = _element$props.disabled,\n      destructive = _element$props.destructive;\n  return {\n    title: title,\n    onPress: onPress,\n    destructive: destructive === true,\n    disabled: disabled === true\n  };\n};\n\nvar checkParams = function checkParams(hiddenButtons) {\n  invariant(Array.isArray(hiddenButtons), 'hiddenButtons must be an array');\n};\n\nexport var overflowMenuPressHandlerActionSheet = function overflowMenuPressHandlerActionSheet(_ref) {\n  var hiddenButtons = _ref.hiddenButtons,\n      _ref$cancelButtonLabe = _ref.cancelButtonLabel,\n      cancelButtonLabel = _ref$cancelButtonLabe === void 0 ? 'Cancel' : _ref$cancelButtonLabe;\n  checkParams(hiddenButtons);\n  var actionTitles = hiddenButtons.map(function (btn) {\n    return btn.title;\n  });\n  actionTitles.unshift(cancelButtonLabel);\n\n  var disabledButtonIndices = function () {\n    var result = [];\n    hiddenButtons.forEach(function (it, index) {\n      if (it.disabled === true) {\n        result.push(index + 1);\n      }\n    });\n    return result;\n  }();\n\n  var destructiveButtonIndex = function () {\n    var result = [];\n    hiddenButtons.forEach(function (it, index) {\n      if (it.destructive === true) {\n        result.push(index + 1);\n      }\n    });\n    return result;\n  }();\n\n  ActionSheetIOS.showActionSheetWithOptions({\n    options: actionTitles,\n    cancelButtonIndex: 0,\n    disabledButtonIndices: disabledButtonIndices,\n    destructiveButtonIndex: destructiveButtonIndex\n  }, function (buttonIndex) {\n    if (buttonIndex > 0) {\n      hiddenButtons[buttonIndex - 1].onPress();\n    }\n  });\n};\nexport var overflowMenuPressHandlerPopupMenu = function overflowMenuPressHandlerPopupMenu(_ref2) {\n  var hiddenButtons = _ref2.hiddenButtons,\n      overflowButtonRef = _ref2.overflowButtonRef;\n  checkParams(hiddenButtons);\n  var enabledButtons = hiddenButtons.filter(function (it) {\n    return it.disabled !== true;\n  });\n  UIManager.showPopupMenu(findNodeHandle(overflowButtonRef), enabledButtons.map(function (btn) {\n    return btn.title;\n  }), function (err) {\n    return console.debug('overflowBtn error', err);\n  }, function (eventName, index) {\n    if (eventName !== 'itemSelected' || typeof index !== 'number') {\n      return;\n    }\n\n    enabledButtons[index].onPress();\n  });\n};\nexport var overflowMenuPressHandlerDropdownMenu = function overflowMenuPressHandlerDropdownMenu(_ref3) {\n  var children = _ref3.children,\n      overflowButtonRef = _ref3.overflowButtonRef,\n      _private_toggleMenu = _ref3._private_toggleMenu;\n\n  if (overflowButtonRef) {\n    overflowButtonRef.measureInWindow(function (x, y, width) {\n      _private_toggleMenu({\n        elements: children,\n        x: x + width,\n        y: y\n      });\n    });\n  } else {}\n};\nexport var defaultOnOverflowMenuPress = Platform.select({\n  ios: overflowMenuPressHandlerActionSheet,\n  default: overflowMenuPressHandlerDropdownMenu\n});","map":{"version":3,"sources":["/Users/user/React-Native/sec 10 Http request & Adding web server + database/node_modules/react-navigation-header-buttons/src/overflowMenuPressHandlers.js"],"names":["React","ActionSheetIOS","HiddenItem","invariant","extractOverflowButtonData","hiddenButtons","detectedElementTypes","btnsData","Children","toArray","map","button","props","type","includes","extract","nestedElement","callSafe","filter","Boolean","element","title","onPress","disabled","destructive","checkParams","Array","isArray","overflowMenuPressHandlerActionSheet","cancelButtonLabel","actionTitles","btn","unshift","disabledButtonIndices","result","forEach","it","index","push","destructiveButtonIndex","showActionSheetWithOptions","options","cancelButtonIndex","buttonIndex","overflowMenuPressHandlerPopupMenu","overflowButtonRef","enabledButtons","UIManager","showPopupMenu","findNodeHandle","err","console","debug","eventName","overflowMenuPressHandlerDropdownMenu","children","_private_toggleMenu","measureInWindow","x","y","width","elements","defaultOnOverflowMenuPress","Platform","select","ios","default"],"mappings":"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","sourcesContent":["// @flow\nimport * as React from 'react';\nimport { Platform, ActionSheetIOS, UIManager, findNodeHandle, typeof View } from 'react-native';\nimport { HiddenItem } from './HeaderItems';\nimport invariant from 'invariant';\nimport type { ToggleMenuParam } from './overflowMenu/OverflowMenuContext';\n\ntype OverflowButtonDescriptors = $ReadOnlyArray<{\n  title: string,\n  onPress: () => void | Promise<void>,\n  destructive?: boolean,\n  disabled?: boolean,\n}>;\n\nexport const extractOverflowButtonData = (\n  hiddenButtons: React.Node,\n  detectedElementTypes: Array<React.StatelessFunctionalComponent<any>> = [HiddenItem]\n): OverflowButtonDescriptors => {\n  // don't do this at home - this is not how React is meant to be used!\n  const btnsData = React.Children.toArray(hiddenButtons).map((button) => {\n    const { props, type } = button;\n    if (detectedElementTypes.includes(type)) {\n      return extract(button);\n    }\n\n    if (typeof type === 'function') {\n      const nestedElement = callSafe(type, props);\n      if (nestedElement && detectedElementTypes.includes(nestedElement.type)) {\n        return extract(nestedElement);\n      }\n    }\n    return false;\n  });\n  // $FlowFixMe\n  return btnsData.filter(Boolean);\n};\n\nconst callSafe = (type, props) => {\n  try {\n    return type(props);\n  } catch {\n    return false;\n  }\n};\n\nconst extract = (element: React.Element<any>) => {\n  const {\n    props: { title, onPress, disabled, destructive },\n  } = element;\n  return { title, onPress, destructive: destructive === true, disabled: disabled === true };\n};\n\nexport type OnOverflowMenuPressParams = {\n  hiddenButtons: OverflowButtonDescriptors,\n  _private_toggleMenu: (ToggleMenuParam) => void,\n  overflowButtonRef: null | View,\n  cancelButtonLabel?: string,\n  children: React.Node,\n};\n\nconst checkParams = (hiddenButtons) => {\n  invariant(Array.isArray(hiddenButtons), 'hiddenButtons must be an array');\n};\n\nexport const overflowMenuPressHandlerActionSheet = ({\n  hiddenButtons,\n  cancelButtonLabel = 'Cancel',\n}: OnOverflowMenuPressParams) => {\n  checkParams(hiddenButtons);\n  let actionTitles = hiddenButtons.map((btn) => btn.title);\n  actionTitles.unshift(cancelButtonLabel);\n\n  const disabledButtonIndices: Array<number> = (() => {\n    let result = [];\n    hiddenButtons.forEach((it, index) => {\n      if (it.disabled === true) {\n        result.push(index + 1);\n      }\n    });\n    return result;\n  })();\n\n  const destructiveButtonIndex: Array<number> = (() => {\n    let result = [];\n    hiddenButtons.forEach((it, index) => {\n      if (it.destructive === true) {\n        result.push(index + 1);\n      }\n    });\n    return result;\n  })();\n\n  ActionSheetIOS.showActionSheetWithOptions(\n    // $FlowFixMe - typings are old\n    {\n      options: actionTitles,\n      cancelButtonIndex: 0,\n      disabledButtonIndices,\n      destructiveButtonIndex,\n    },\n    (buttonIndex: number) => {\n      if (buttonIndex > 0) {\n        hiddenButtons[buttonIndex - 1].onPress();\n      }\n    }\n  );\n};\n\nexport const overflowMenuPressHandlerPopupMenu = ({\n  hiddenButtons,\n  overflowButtonRef,\n}: OnOverflowMenuPressParams) => {\n  checkParams(hiddenButtons);\n  const enabledButtons = hiddenButtons.filter((it) => it.disabled !== true);\n\n  UIManager.showPopupMenu(\n    findNodeHandle(overflowButtonRef),\n    enabledButtons.map((btn) => btn.title),\n    (err) => console.debug('overflowBtn error', err),\n    (eventName: string, index?: number) => {\n      if (eventName !== 'itemSelected' || typeof index !== 'number') {\n        return;\n      }\n      enabledButtons[index].onPress();\n    }\n  );\n};\n\nexport const overflowMenuPressHandlerDropdownMenu = ({\n  children,\n  overflowButtonRef,\n  _private_toggleMenu,\n}: OnOverflowMenuPressParams) => {\n  if (overflowButtonRef) {\n    // $FlowFixMe\n    overflowButtonRef.measureInWindow((x, y, width) => {\n      _private_toggleMenu({ elements: children, x: x + width, y });\n    });\n  } else {\n    // TODO ignore or show?\n  }\n};\n\nexport const defaultOnOverflowMenuPress: (OnOverflowMenuPressParams) => void = Platform.select({\n  ios: overflowMenuPressHandlerActionSheet,\n  default: overflowMenuPressHandlerDropdownMenu,\n});\n"]},"metadata":{},"sourceType":"module"}